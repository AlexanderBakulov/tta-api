##TrackThemAll!
учебная задача по разработке системы мониторинга обращений
#Термины и определения
Система - система мониторинга Обращений “TrackThemAll!”
Компания – заказчик Системы
Поддержка – Департамент поддержки Компании, занимается решением технических проблем, возникающих у сотрудников компании 
и препятствующих исполнению ими должностных обязанностей
Обращение – сформированное пользователем Системы обращение в Поддержку о возникшей проблеме, решение которой находится 
в компетенции Поддержки
Приоритет – приоритет Обращения, зависит от влияния проблемы на деловые процессы Компании (Приоритеты детализированы ниже)
Заявитель – пользователь, сформировавший Обращение
Исполнитель – сотрудник Поддержки получивший Обращение на исполнение

#Исходные данные
Компания занимается консультационными услугами. Численность порядка 150 человек. Структура – головной офис (Москва MSK) и 
два филиала (С-Петербург, SPB и Новосибирск NSK). Далее для простоты все они будут называться офисами.
Количество сотрудников: MSK – 70 чел., SPB – 60 чел., NSK – 20 чел.
Собственной ИТ-инфраструктуры не имеет, за исключением абонентских комплектов (персональные компьютеры, IP-телефоны) и 
локальной сети. В каждом офисе основной и резервный канал доступа в Интернет от двух разных провайдеров.
Приложения Компании развернуты в Amazon AWS.
Компания имеет Департамент Поддержки, занимающийся решением проблем, препятствующих сотрудникам выполнять их должностные 
обязанности (такие как настройка ПО, замена неисправного оборудования, взаимодействие с интернет-провайдерами и т.п.)
Сотрудники Поддержки распределены по офисам: MSK – 5 чел., SPB – 3 чел., NSK – 2 чел.
В настоящее время процесс подачи Обращений пользователей в Поддержку не формализован, возможны личные обращения, по 
телефону, учета обращений не ведется.
Сотрудники Поддержки, получая обращение, стараются его решить и если проблема не решается собственными силами (ремонт 
оборудования, проблемы с провайдером), производят эскалацию проблемы на соответствующих компетентных специалистов вне 
компании. Обратная связь с инициатором обращения отсутствует.
Сотрудники и руководство компании недовольны работой Департамента Поддержки. Проблемы решаются очень медленно. В свою 
очередь, руководитель Поддержки утверждает, что сотрудники поддержки перегружены и необходимо увеличить штат персонала 
Поддержки.

##Задача
Руководство Компании решило разработать Систему мониторинга Обращений. 
Задачи Системы:
1) Автоматическое распределение Обращений в соответствии с их Приоритетами.
2) Оптимизация штата Поддержки.

#Общие требования к системе
Необходимо разработать Систему мониторинга обращений, которая позволит сотрудникам Компании формировать Обращения 
к Поддержке о возникших проблемах в работе и подтверждать исполнение этих Обращений. 
Система должна автоматически назначать Обращение на наименее занятого сотрудника Поддержки в соответствии с Приоритетом 
Обращения. При распределении должно учитываться в каком из офисов работает Заявитель. Обращение должно распределяться на 
Исполнителя, работающего в том же офисе.
Система должна фиксировать время ожидания Обращения до назначения Исполнителю и время исполнения Обращения.
Система должна иметь возможность формирования отчетов о производительности и загруженности Поддержки.

##Техническая спецификация
#Функциональные требования
1. Статусы пользователей системы:
USER – формирует Обращения. Может общаться с Исполнителем в режиме чата. Видит текущий статус Обращения. Может принять 
(Confirm) или вернуть в работу (Reject) исполненное обращение. Может найти все свои исполненные обращения в Архиве.
MANAGER – может производить те же действия, что и USER, но кроме того может смотреть отчеты, формируемые Системой.
SUPPORT – получает Обращение на исполнение. Может отложить обращение (Hold), отказать в исполнении (Support reject), 
изменить приоритет обращения, если считает, что текущий приоритет неправильный (опция для отчета, фактически приоритет 
не меняется), исполнить Обращение, запросить у Заявителя дополнительную информацию в режиме чата (потенциальная возможность 
для будущих версий). Может видеть все назначенные ему обращения.
2. Пользователь входит в Систему используя логин и пароль. Логин и первичный пароль задаются Администратором при регистрации
пользователя в Системе. При первом входе Пользователь должен сменить первичный пароль на текущий. При последующих входах – 
использует текущий пароль. Пользователь может в любое время изменить текущий пароль. Администратор при необходимости может
сбросить пароль пользователя (задать новый первичный пароль). В таком случае следующий вход Пользователя в Систему 
осуществляется по правилам первого входа.
3. Система автоматически назначает Обращения на сотрудников Поддержки по следующим правилам:
3.1. Обращение назначается на Исполнителя, находящегося в том же филиале, что и Заявитель.
3.2. Если в очереди нет обращений того же или более высокого приоритета, что и текущее Обращение, назначение происходит 
на следующего незанятого сотрудника Поддержки. Незанятые сотрудники поддержки находятся в очереди, Обращение назначается 
на первого в очереди, исполнивший обращение становится в конец очереди. Так достигается равномерное распределение Обращений 
между сотрудниками Поддержки.
3.3. Если в очереди есть другие обращения (нет свободных сотрудников Поддержки), то обращение ставится в очередь в 
соответствии с: приоритетом, временем обращения.
3.4. Для каждого приоритета (за исключением наивысшего) существует максимальное время ожидания. Если время истекло и 
Обращение не взято в работу, приоритет Обращения повышается с соответственным изменением положения в очереди.
3.5. Обращение вне зависимости от приоритета назначается только на свободного сотрудника Поддержки.
4. Уровни приоритета (от большего к меньшему):
4.1. URGENT – очень критичное Обращение, Компания теряет деньги
4.2. CRITICAL – пользователь не может работать
4.3. MEDIUM – пользователь имеет проблемы, но может продолжать работу (с неудобствами или ограничениями)
4.4. LOW – у пользователя есть какие-либо пожелания
5. Максимальное время ожидания, по истечении которого повышается приоритет ожидающего Обращения (конфигурируемый параметр, 
приведены значения по умолчанию)
5.1. CRITICAL – 2 часа
5.2. MEDIUM – 8 часов
5.3. LOW – 16 часов
6. При формировании Обращения должны быть определены следующие атрибуты:
6.1. Тема обращения (обязательный параметр)
6.2. Приоритет обращения (обязательный параметр)
6.3. Описание проблемы (обязательный параметр)
6.4. Инициатор – задается системой автоматически
7. Статусы исполнения Обращения
Создано (Created) –Заявитель корректно ввел все необходимые атрибуты и подтвердил обращение.
В очереди (Queued) – Обращение поставлено в очередь
В работе (In work) – обращение в работе, назначен Исполнитель
Исполнено (Reported as done) – обращение исполнено
Подтверждено (Confirmed) – исполнение подтверждено Заявителем, Обращение закрыто
Вернуть в работу (Rejected) – обращение возвращено в работу, исполнение не подтверждено
Отклонено Поддержкой (Support reject) – проблема вне компетенции Поддержки, Обращение закрыто.
В ожидании (Hold) – обращение поставлено в ожидание на заданное время, так как решение зависит от внешних факторов 
(например, ремонт оборудования), по истечении времени Обращение переходит в статус В работе.
	Если Заявитель не Подтверждает и не Отклоняет исполненное обращение в течении заданного времени (настраиваемый параметр, 
  по умолчанию 24 часа) обращение автоматически получает статус Подтверждено.
	Отклоненное обращение попадает в персональную очередь Исполнителя и по завершении им текущей задачи назначается ему 
  повторно.
8. При изменении статуса Обращения пользователь может добавить комментарий
Статусы In work, Confirmed as done, Hold, Support reject комментируются Исполнителем.
Статусы Confirmed, Rejected – комментируются Заявителем.
9. Система должна по запросу формировать следующие отчеты:
9.1. Свободное время – сколько времени специалисты Поддержки были не заняты за выбранный период. С разбивкой по дням, по 
неделям, в целом за период. И гистограмма распределения незанятого времени по часам в рабочее время в течении выбранного 
периода. Для каждого филиала формируется отдельный отчет.
9.2. Длительность исполнения – средняя длительность исполнения Обращений по приоритету (изначальному приоритету, не 
читывая автоматического изменения приоритета системой) за выбранный период. В целом по департаменту, по филиалу, по каждому 
сотруднику поддержки. Также должно отображаться количество Rejected Обращений по каждому сотруднику Поддержки. Для каждого 
филиала формируется отдельный отчет. Отчет формируется только по закрытым (Confirmed) Обращениям.
9.3. Отчет по некорректным обращениям – отображаются обращения за заданный период, для которых сотрудник поддержки исправил 
приоритет. Здесь же отображаются Обращения со статусом Support reject. Для каждого филиала формируется отдельный отчет.
10. Дополнительные требования
10.1. При расчете длительностей для отчета используются только рабочие часы. Например: завершение рабочего дня в 17:00, 
обращение взято в работу в 16:00, рабочий день начинается в 8:00, обращение выполнено в 9:00 следующего дня. Длительность 
исполнения обращения – 2 часа. Рабочие часы не включают время обеденного перерыва.
10.2. Время начала и окончания рабочего дня и время обеденного перерыва – конфигурируемые параметры. По умолчанию: начало 
рабочего дня в 8:00, завершение 17:00, обеденный перерыв 12:00 – 13:00. Данные параметры должны конфигурироваться для 
каждого филиала отдельно.
10.3. Длительность исполнения Отклоненного Обращения складывается из суммы длительностей в работе, исключая время между 
Reported as done Исполнителя и Rejected Инициатора.
11. Администратор системы – отдельная учетная запись не связанная со статусами пользователей системы.
11.1. Администратор может добавлять в систему новых пользователей, изменять данные пользователей, сбрасывать пароли 
пользователей, блокировать пользователей системы.
При добавлении нового пользователя вводятся следующие данные:
Фамилия, имя, должность, логин, адрес почты, офис, статус в системе, временный пароль.
11.2. При первом входе в систему пользователь обязан сменить временный пароль на свой собственный, соответствующий 
требованиям безопасности Компании к паролям.
11.3. Администратор может сбросить пароль пользователя на временный, в таком случае следующий вход в Систему происходит по 
правилам первого входа.

##Нефункциональные требования
#Technology stack
Gradle
Java Spring Boot, JPA
MySQL
Elasticsearch Service
ReactJs - для UI
Docker
JUnit, Mockito
Checkstyle, Jenkins, Swagger

#Тестирование

Юнит-тесты должны быть разработаны для автоматического алгоритма назначения, для логики рабочего потока, для отчетов.

#Деплоймент

Для сервисов окружения должны предоставляться Докер-образы.
Должно быть создано задание Jenkins для развертывания версий приложений в докер-образах.
При деплое должны запускаться автотесты.


#Производительность 

С учетом текущего количества сотрудников Компании производительность системы должна быть достаточна, чтобы обеспечивать 
в пиковом режиме ведение до нескольких сотен активных обращений. В пиковом режиме система должна обрабатывать десятки 
одновременно подаваемых обращений.


#Удобство сопровождения 

Система должна быть разработана таким образом, чтобы минимизировать усилия по устранению ошибок, внесению изменений и 
расширению функционала системы.
Добавление нового отчета без добавления новых данных в систему должно занимать не больше недели.
В системе должны логироваться следующие события: (уровень INFO) вход пользователя в систему, выход пользователя из 
системы, добавление нового пользователя, изменение данных пользователя, создание обращения, исполнение обращения, 
подтверждение обращения, возврат обращения в работу; (уровень WARNING) возникновение исключения, не влияющего на работу 
системы; (уровень ERROR)  возникновение исключения, влияющего на работу системы; (уровень CRITICAL) отсутствие подключения 
к базе данных, исключения, критически влияющие на работу системы. 
Лог должен вестись в виде текстового файла с именем log-tha-yyyymmdd.txt, где yyyy год mm месяц dd день текущей даты. 
Событие должно логироваться с указанием даты и времени каждого события, уровня события и поясняющего текста. Ежедневно 
в 0:00 лог-файл должен архивироваться и создаваться новый лог-файл. 

#Расширяемость 

Система должна быть спроектирована с учетом возможности расширения. В следующие  5 лет система должна обеспечивать 
потребности Компании с учетом возможного увеличения штата Компании, открытия дополнительных офисов. При проектировании 
необходимо избегать узких мест, которые могут препятствовать расширению системы.

#Надежность 

Падение одного из сервисов системы по возможности не должно приводить к падению системы в целом. Состояние сервисов должно 
мониториться, в случае падения сервиса он должен автоматически перезапускаться.

#Факторы эксплуатации

Инфраструктура системы будет развернута на базе Amazon AWS. Разработанное приложение должно быть совместимо с 
инфраструктурой. Разработчик должен предоставить Заказчику документацию по развертыванию и настройке системы в AWS.
